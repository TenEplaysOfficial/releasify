var b=require("https"),g=JSON.parse(process.env.GITHUB_EVENT||"{}"),e=process.env.GITHUB_REPOSITORY||"unknown/repo",o=g.release||{},s=o.tag_name||"v?.?",d=o.html_url||`https://github.com/${e}`,v=o.body||"_No release notes provided._",_=o.published_at||new Date().toISOString(),$=o.target_commitish||"main",f=o.assets||[],a=o.author||{},p=a.login||"unknown",w=a.html_url||`https://github.com/${p}`,k=a.avatar_url||"https://github.githubassets.com/favicons/favicon.png",C=process.env.webhook,u=process.env.title||`\u{1F680} New Release: \`${s}\` in \`${e}\``,O=process.env.footer||e,N=process.env.username||e.split("/")[1]?.[0]?.toUpperCase()+"Bot",S=process.env.avatar_url||"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",T=parseInt((process.env.color||"7289da").replace(/^#/,""),16),y=process.env.mention||"",i=process.env.thumbnail,l=process.env.image,I=o.zipball_url||`https://github.com/${e}/zipball/${s}`,B=o.tarball_url||`https://github.com/${e}/tarball/${s}`,L=f.map(t=>`[${t.name}](${t.browser_download_url})`),R=[...L,`[ZIP](${I})`,`[TAR](${B})`].filter(Boolean).join(" | "),r={title:u,url:d,description:v,color:T,timestamp:_,footer:{text:O},author:{name:p,url:w,icon_url:k},fields:[{name:"Source Code",value:R||"No downloads found.",inline:!1},{name:"Compare Changes",value:`[Compare commits](https://github.com/${e}/compare/${$}...${s})`,inline:!1}]};i&&(r.thumbnail={url:i});l&&(r.image={url:l});var h=JSON.stringify({username:N,avatar_url:S,content:`${y} ${u}`.trim(),embeds:[r]}),n=new URL(C),j={method:"POST",hostname:n.hostname,path:n.pathname+n.search,headers:{"Content-Type":"application/json","Content-Length":Buffer.byteLength(h)}},c=b.request(j,t=>{console.log(`\u2705 Discord webhook response: ${t.statusCode}`),t.on("data",m=>process.stdout.write(m))});c.on("error",t=>{console.error("\u274C Webhook failed:",t)});c.write(h);c.end();
